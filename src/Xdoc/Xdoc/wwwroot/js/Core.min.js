var CookieWorker=function(){function n(){}return n.prototype.setCookie=function(n,t,i){var u="",r;i&&(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString());document.cookie=n+"="+(t||"")+u+"; path=/"},n.prototype.getCookie=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1,t.length);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return null},n.prototype.eraseCookie=function(n){document.cookie=n+"=; Max-Age=-99999999;"},n}(),FormDataHelper=function(){function n(){this.NullValue="VALUE_NULL";this.DataTypeAttributeName="data-type"}return n.prototype.FillDataByPrefix=function(n,t){var f,r,e,i,o,s,u,h,c;for(f in n)if((r=n[f],r!==null&&r!==undefined)&&(e=t+f,i=document.getElementsByName(e)[0],i!==null&&i!==undefined)){if(Array.isArray(r)){for(i.type!=="select-multiple"&&alert("An attempt to set an array to HTMLInputElement which is not a select with multiple attribute"),o=i,s=function(n){var t=o.options[n],i=r.filter(function(n){return t.value===n}).length>0;t.selected=i},u=0;u<o.options.length;u++)s(u);h=new Event("change");i.dispatchEvent(h);continue}i.type==="checkbox"?i.checked=r:i.type==="radio"?document.querySelector("input[name="+e+"][value="+r+"]").checked=!0:i.value=r;c=new Event("change");i.dispatchEvent(c)}},n.prototype.CollectDataByPrefix=function(n,t){var i,u,r,f;for(i in n)if(n.hasOwnProperty(i)){if(u=t+i,r=document.getElementsByName(u)[0],r==null){alert("Элемент не найден по указанному имени "+u);return}f=this.GetRawValueFromElement(r);n[i]=this.ValueMapper(f,r.getAttribute(this.DataTypeAttributeName))}},n.prototype.GetRawValueFromElement=function(n){var i,t;return n.type==="select-multiple"?Array.apply(null,n.options).filter(function(n){return n.selected}).map(function(n){return n.value}):n.type==="radio"?(i=document.querySelector('input[name="'+name+'"]:checked')!=null,i)?(t=document.querySelector('input[name="'+name+'"]:checked'),console.log("FormDataHelper.Radio",t),t.value):null:n.type==="checkbox"?n.checked:n.value},n.prototype.CollectDataByPrefixWithTypeMatching=function(n,t){var i,r,u,f;for(this.CheckData(t),i=this.BuildObject(t),this.CollectDataByPrefix(i,n),r=0;r<t.Properties.length;r++)u=t.Properties[r],f=this.GetInitValue(i[u.PropertyDescription.PropertyName]),i[u.PropertyDescription.PropertyName]=this.ValueMapper(f,u.TypeName);return i},n.prototype.ValueMapper=function(n,t){if(console.log("FormDataHelper.ValueMapper",n,t),n===this.NullValue)return null;switch(t){case CSharpType.DateTime.toString():return new Date(n);case CSharpType.Decimal.toString():return n!==null?Number(n.replace(/,/g,".")):null;case CSharpType.Boolean.toString():return n!==null?n.toLowerCase()==="true":null}return n},n.prototype.GetInitValue=function(n){var t=n;return t===this.NullValue?null:t},n.prototype.CheckData=function(n){if(!n.IsClass){var t="Тип не являющийся классом не поддерживается";alert(t);throw Error(t);}},n.prototype.BuildObject=function(n){for(var r,i={},t=0;t<n.Properties.length;t++)r=n.Properties[t],i[r.PropertyDescription.PropertyName]="";return i},n}(),CrocoJsApplication=function(){function n(){}return n}(),FormDataUtils=function(){function n(){}return n.prototype.GetStartUrlNoParams=function(n){return(n===void 0&&(n=null),n=n==null?window.location.href:n,!n.includes("?"))?n:n.split("?")[0]},n.prototype.GetUrlParamsObject=function(n){var u,i,r,t,e,f;if(n===void 0&&(n=null),n=n==null?window.location.href:n,u=unescape(n),i={},!u.includes("?"))return i;for(r=u.split("?")[1].split("&"),t=0;t<r.length;t++)(e=r[t],e.includes("="))&&(f=r[t].split("="),i[f[0]]=f[1]);return i},n.prototype.ProccessStringPropertiesAsDateTime=function(n,t){var u=this,i,r;if(Array.isArray(n))return n.map(function(n){return u.ProccessStringPropertiesAsDateTime(n,t)});for(i in n){if(r=n[i],Array.isArray(r)){n[i]=r.map(function(n){return u.ProccessStringPropertiesAsDateTime(n,t)});continue}if(r instanceof Object&&r.constructor===Object){n[i]=this.ProccessStringPropertiesAsDateTime(r,t);continue}t.findIndex(function(n){return n===i})>-1&&n[i]!=null&&(n[i]=new Date(r))}return n},n.prototype.ProccessAllDateTimePropertiesAsString=function(n){for(var t in n)Object.prototype.toString.call(n[t])==="[object Date]"&&(n[t]=n[t].toISOString());return n},n}(),CSharpType,DatePickerUtils,ImageSizeType,TimePickerUtils,Utils,UserInterfaceType;(function(n){n[n.String="String"]="String";n[n.Int="Int"]="Int";n[n.Decimal="Decimal"]="Decimal";n[n.Boolean="Boolean"]="Boolean";n[n.DateTime="DateTime"]="DateTime"})(CSharpType||(CSharpType={}));DatePickerUtils=function(){function n(){}return n.InitDictionary=function(){$.fn.datepicker.dates.ru={days:["понедельник","воскресенье","вторник","среда","четверг","пятница","суббота"],daysShort:["вс","пн","вт","ср","чт","пт","сб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Today"}},n.SetDatePicker=function(t,i,r){var f,e,u,o,s;r===void 0&&(r=null);f=document.getElementById(t);f==null&&alert("Utils.SetDatePicker Элемент с идентификатором "+t+" не найден на странице");e=document.getElementById(i);e==null&&alert("Utils.SetDatePicker Элемент с идентификатором "+i+" не найден на странице");u="#"+t;$(u).datepicker({format:"dd/mm/yyyy",autoclose:!0,language:"ru",zIndexOffset:1e3});n.ActiveDatePickers.push({BackElementId:i,DatePickerId:t});$(u).on("change",function(t){var f=t.target.value,r=new Date(n.DDMMYYYYToMMDDDDYYYYString(f)),u;isNaN(r.getTime())&&(r=null);u=r==null?CrocoAppCore.Application.FormDataHelper.NullValue:new Date(r.getTime()-r.getTimezoneOffset()*6e4).toISOString().split("T")[0];console.log("Utils.DatePickerValueChanged",r,u);document.getElementById(i).value=u});o=new Event("change");s=document.getElementById(t);s.dispatchEvent(o);r!==undefined&&n.SetDateToDatePicker(t,r)},n.SetDateToDatePicker=function(n,t){var i="#"+n;$(i).datepicker("setDate",t)},n.DDMMYYYYToMMDDDDYYYYString=function(n){var t=n.split("/");return t[1]+"/"+t[0]+"/"+t[2]},n.GetDateFromDatePicker=function(t){var i=n.ActiveDatePickers.find(function(n){return n.DatePickerId===t});return i==null&&alert("DatePicker с идентификатором "+t+" не инициалиирован на странице"),new Date(document.getElementById(i.BackElementId).value)},n.ActiveDatePickers=[],n}();DatePickerUtils.InitDictionary(),function(n){n[n.Icon="Icon"]="Icon";n[n.Medium="Medium"]="Medium";n[n.Small="Small"]="Small";n[n.Original="Original"]="Original"}(ImageSizeType||(ImageSizeType={}));TimePickerUtils=function(){function n(){}return n.SetTimePicker=function(n){$("#"+n).timepicker()},n.GetTimeValueInMinutes=function(n){var i=document.getElementById(n),t;if(i==null){alert("Элемент с идентификатором '"+n+"' не найден на странице");return}if(t=i.value,t=="12:00 AM")return 0;var r=t.split(" "),u=r[0].split(":").map(function(n){return Number(n)}),f=u[0]*60+u[1];return r[1]=="PM"?f+720:f},n}();Utils=function(){function n(){}return n.FillSelect=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=document.createElement("option"),f.innerHTML=i(t[u]),f.value=r(t[u]),n.append(f)},n.GetImageLinkByFileId=function(n,t){return"/FileCopies/Images/"+t.toString()+"/"+n+".jpg"},n}(),function(n){n[n.CustomInput="CustomInput"]="CustomInput";n[n.TextBox="TextBox"]="TextBox";n[n.TextArea="TextArea"]="TextArea";n[n.DropDownList="DropDownList"]="DropDownList";n[n.Hidden="Hidden"]="Hidden";n[n.DatePicker="DatePicker"]="DatePicker";n[n.MultipleDropDownList="MultipleDropDownList"]="MultipleDropDownList"}(UserInterfaceType||(UserInterfaceType={}));var FormDrawFactory=function(){function n(n){this._defaultImplementation=n.DefaultImplementation;this._implementations=n.Implementations}return n.prototype.GetImplementation=function(n,t){var i=this._implementations.get(t);return i==null?this._defaultImplementation(n):i(n)},n}(),FormDrawHelper=function(){function n(){}return n.GetPropertyValueName=function(n,t){return""+t+n},n.GetOuterFormElement=function(t,i){return document.querySelector("["+n.FormPropertyName+'="'+t+'"]['+n.FormModelPrefix+'="'+i+'"]')},n.GetOuterFormAttributes=function(t,i){return n.FormPropertyName+'="'+t+'" '+n.FormModelPrefix+'="'+i+'"'},n.GetInputTypeHidden=function(n,t,i){i===void 0&&(i=null);var r=i!=null?i:new Map;return r.set("value",t),r.set("name",n),HtmlDrawHelper.RenderInput("hidden",r)},n.FormPropertyName="form-property-name",n.FormModelPrefix="form-model-prefix",n}(),HtmlDrawHelper=function(){function n(){}return n.RenderInput=function(t,i){var r=n.RenderAttributesString(i);return"<input type="+t+" "+r+"/>"},n.RenderAttributesString=function(n){var u="",t,f,i,r;if(n==null)return u;for(t=0,f=Array.from(n.keys());t<f.length;t++)i=f[t],r=n.get(i),u+=r==null||r===""?" "+i:" "+i+'="'+r+'"';return u},n.RenderSelect=function(t,i,r,u){for(var f,s,h=n.RenderAttributesString(u),o="<select"+h+' class="'+t+'" name="'+i+'">',e=0;e<r.length;e++)f=r[e],s=f.Selected?' selected="selected"':"",o+="<option"+s+' value="'+f.Value+'">'+f.Text+"<\/option>";return o+"<\/select>"},n}(),HtmlSelectDrawHelper=function(){function n(n){this.NullValue=n}return n.prototype.ProccessSelectValues=function(n,t,i){var u=this,r;i.forEach(function(n){n.Value==null&&(n.Value=u.NullValue)});t!=null&&(i.forEach(function(n){return n.Selected=!1}),r=n.TypeName==CSharpType.Boolean.toString()?i.find(function(n){return n.Value.toLowerCase()==t.toLowerCase()}):i.find(function(n){return n.Value==t}),r!=null&&(r.Selected=!0))},n}(),ValueProviderHelper=function(){function n(){}return n.GetStringValueFromValueProvider=function(t,i){var r=n.GetRawValueFromValueProvider(t,i);return r==null?"":r},n.GetRawValueFromValueProvider=function(n,t){if(t==null)return null;if(!n.IsEnumerable){var i=t.Singles.find(function(t){return t.PropertyName==n.PropertyDescription.PropertyName});return i==null?null:i.Value}return""},n}(),CrocoTypeDescriptionOverrider=function(){function n(){}return n.FindUserInterfacePropBlockByPropertyName=function(n,t){var i=n.Blocks.find(function(n){return n.PropertyName===t});if(i==null){alert("Свойство '"+t+"' не найдено в модели обобщенного пользоватлеьского интерфейса");return}return i},n.SetUserInterfaceTypeForProperty=function(t,i,r){var u=n.FindUserInterfacePropBlockByPropertyName(t,i);u.InterfaceType=r},n.RemoveProperty=function(n,t){n.Blocks=n.Blocks.filter(function(n){return n.PropertyName!==t})},n.SetLabelText=function(t,i,r){n.FindUserInterfacePropBlockByPropertyName(t,i).LabelText=r},n.SetHidden=function(t,i){n.SetUserInterfaceTypeForProperty(t,i,UserInterfaceType.Hidden)},n.SetTextArea=function(t,i){n.SetUserInterfaceTypeForProperty(t,i,UserInterfaceType.TextArea)},n.SetDropDownList=function(t,i,r){var u=n.FindUserInterfacePropBlockByPropertyName(t,i);u.InterfaceType=UserInterfaceType.DropDownList;u.SelectList=r},n}(),FormTypeAfterDrawnDrawer=function(){function n(){}return n.SetInnerHtmlForProperty=function(n,t,i){var r=FormDrawHelper.GetOuterFormElement(n,t);console.log("SetInnerHtmlForProperty elem",r);r.innerHTML=i},n}(),FormTypeDrawer=function(){function n(n,t){this._formDrawer=n;this._typeDescription=t}return n.prototype.BeforeFormDrawing=function(){this._formDrawer.BeforeFormDrawing()},n.prototype.AfterFormDrawing=function(){this._formDrawer.AfterFormDrawing()},n.prototype.TextBoxFor=function(n,t){var i=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderTextBox(i,t)},n.prototype.DatePickerFor=function(n,t){var i=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderDatePicker(i,t)},n.prototype.TextAreaFor=function(n,t){var i=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderTextArea(i,t)},n.prototype.DropDownFor=function(n,t,i){var r=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderDropDownList(r,t,i)},n.prototype.MultipleDropDownFor=function(n,t,i){var r=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderMultipleDropDownList(r,t,i)},n.prototype.HiddenFor=function(n,t){var i=PropertyFormTypeSearcher.FindPropByName(this._typeDescription,n);return this._formDrawer.RenderHidden(i,t)},n}(),FormTypeDrawerModelBuilder=function(){function n(n){this._model=n}return n.prototype.SetMultipleDropDownListFor=function(n,t){var i=this.GetPropertyBlockByName(n);return i.InterfaceType=UserInterfaceType.MultipleDropDownList,i.SelectList=t,this.ResetBlock(i),this},n.prototype.SetDropDownListFor=function(n,t){var i=this.GetPropertyBlockByName(n);return i.InterfaceType=UserInterfaceType.DropDownList,i.SelectList=t,this.ResetBlock(i),this},n.prototype.SetTextAreaFor=function(n){var t=this.GetPropertyBlockByName(n);if(t.InterfaceType!=UserInterfaceType.TextBox)throw new Error("Только элементы с типом "+UserInterfaceType.TextBox+" можно переключать на "+UserInterfaceType.TextArea);return t.InterfaceType=UserInterfaceType.TextArea,this.ResetBlock(t),this},n.prototype.SetHiddenFor=function(n){var t=this.GetPropertyBlockByName(n);return t.InterfaceType=UserInterfaceType.Hidden,this.ResetBlock(t),this},n.prototype.ResetBlock=function(n){var t=this._model.Blocks.findIndex(function(t){return t.PropertyName==n.PropertyName});this._model.Blocks[t]=n},n.prototype.GetPropertyBlockByName=function(n){var t=this._model.Blocks.find(function(t){return t.PropertyName==n});if(t==null)throw new Error("Блок не найден по указанному имени "+n);return t},n}(),GenericForm=function(){function n(t){this._genericInterfaces=[];t.FormDrawFactory==null&&n.ThrowError("Фабрика реализаций отрисовки обобщенных форм == null. Проверьте заполнение свойства opts.FormDrawFactory");this._formDrawFactory=t.FormDrawFactory}return n.UnWrapModel=function(n,t){for(var i,r="",u=0;u<n.Blocks.length;u++){i=n.Blocks[u];switch(i.InterfaceType){case UserInterfaceType.TextBox:r+=t.TextBoxFor(i.PropertyName,!0);break;case UserInterfaceType.TextArea:r+=t.TextAreaFor(i.PropertyName,!0);break;case UserInterfaceType.DropDownList:r+=t.DropDownFor(i.PropertyName,i.SelectList,!0);break;case UserInterfaceType.Hidden:r+=t.HiddenFor(i.PropertyName,!0);break;case UserInterfaceType.DatePicker:r+=t.DatePickerFor(i.PropertyName,!0);break;case UserInterfaceType.MultipleDropDownList:r+=t.MultipleDropDownFor(i.PropertyName,i.SelectList,!0);break;default:console.log("Данный блок не реализован",i);throw new Error("Не реализовано");}}return r},n.ThrowError=function(n){alert(n);throw Error(n);},n.prototype.DrawForms=function(){for(var t=document.getElementsByClassName("generic-user-interface"),n=0;n<t.length;n++)this.FindFormAndSave(t[n]);for(n=0;n<this._genericInterfaces.length;n++)this.DrawForm(this._genericInterfaces[n])},n.prototype.FindFormAndSave=function(t){var i=t.getAttribute("data-id"),r=window[i];r!=null&&(t.id==null&&(console.log(t),n.ThrowError("На странице имеются элементы с настройками для генерации обобщенного интерфейса, но у элемента нет идентификатора")),this._genericInterfaces.push({ElementId:t.id,FormDrawKey:"",FormModel:r}),window[i]=null)},n.prototype.DrawForm=function(t){var u=this._formDrawFactory.GetImplementation(t.FormModel,t.FormDrawKey),i=new FormTypeDrawer(u,t.FormModel.TypeDescription),r;i.BeforeFormDrawing();r=document.getElementById(t.ElementId);r==null&&n.ThrowError("Элемент с идентификатором "+t.ElementId+" не найден на странице");r.innerHTML=n.UnWrapModel(t.FormModel,i);i.AfterFormDrawing()},n}(),PropertyFormTypeSearcher=function(){function n(){}return n.FindPropByNameInOneDimension=function(n,t){return n.Properties.find(function(n){return n.PropertyDescription.PropertyName===t})},n.FindPropByName=function(t,i){var r;if(i.includes(".")){var u=i.indexOf("."),f=i.slice(0,u),e=i.slice(u+1,i.length),o=n.FindPropByNameInOneDimension(t,f);return n.FindPropByName(o,e)}if(r=n.FindPropByNameInOneDimension(t,i),r==null)throw new Error("Свойство "+i+" не найдено");return r},n}(),ValueProviderBuilder=function(){function n(){}return n.CreateFromObject=function(n){var i,r,t;n=CrocoAppCore.Application.FormDataUtils.ProccessAllDateTimePropertiesAsString(n);i={Arrays:[],Singles:[]};for(r in n)(t=n[r],Array.isArray(t))||t!==undefined&&i.Singles.push({PropertyName:r,Value:t});return i},n}(),AjaxLoader=function(){function n(){}return n.prototype.InitAjaxLoads=function(){for(var t=document.getElementsByClassName("ajax-load-html"),n=0;n<t.length;n++)this.LoadInnerHtmlToElement(t[n],null)},n.prototype.LoadInnerHtmlToElement=function(n,t){var r=$(n).data("ajax-link"),i=$(n).data("ajax-method"),f=$(n).data("request-data"),u=$(n).data("on-finish-script");i==null&&(i="GET");$.ajax({type:i,url:r,cache:!1,data:f,success:function(i){$(n).html(i);$(n).removeClass("ajax-load-html");u&&eval(u);t&&t()},error:function(n){alert("There is an execption while executing request "+r);console.log(n)}})},n}(),FormDrawImplementation=function(){function n(n){this._datePickerPropNames=[];this._selectClass="form-draw-select";this._model=n;this._htmlDrawHelper=new HtmlSelectDrawHelper(CrocoAppCore.Application.FormDataHelper.NullValue)}return n.prototype.BeforeFormDrawing=function(){},n.prototype.AfterFormDrawing=function(){var t,i;for($("."+this._selectClass).selectpicker("refresh"),t=0;t<this._datePickerPropNames.length;t++)i=this._datePickerPropNames[t],n.InitCalendarForPrefixedProperty(this._model.Prefix,i)},n.prototype.GetPropertyName=function(n){return FormDrawHelper.GetPropertyValueName(n,this._model.Prefix)},n.prototype.GetPropertyBlock=function(n){return this._model.Blocks.find(function(t){return t.PropertyName===n})},n.GetElementIdForFakeCalendar=function(n,t){var i=n+"_"+t+"FakeCalendar";return i.replace(new RegExp(/\./,"g"),"_")},n.GetElementIdForRealCalendarBackProperty=function(n,t){var i=n+"_"+t+"RealCalendar";return i.replace(new RegExp(/\./,"g"),"_")},n.InitCalendarForPrefixedProperty=function(t,i){var r=n.GetElementIdForFakeCalendar(t,i),u=n.GetElementIdForRealCalendarBackProperty(t,i);DatePickerUtils.SetDatePicker(r,u)},n.prototype.GetPropValue=function(n){return ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider)},n.prototype.RenderDatePicker=function(t,i){var r=t.PropertyDescription.PropertyName,u=this.GetPropertyName(r),f,e;return this._datePickerPropNames.push(r),f=n.GetElementIdForFakeCalendar(this._model.Prefix,r),e=(new Map).set("id",n.GetElementIdForRealCalendarBackProperty(this._model.Prefix,r)).set(CrocoAppCore.Application.FormDataHelper.DataTypeAttributeName,CSharpType.String.toString()),this.RenderTextBoxInner(t,i,f,u+"Fake")+FormDrawHelper.GetInputTypeHidden(u,"",e)},n.prototype.RenderHidden=function(n){var t=this.GetPropValue(n);return FormDrawHelper.GetInputTypeHidden(FormDrawHelper.GetPropertyValueName(n.PropertyDescription.PropertyName,this._model.Prefix),t,null)},n.prototype.RenderTextBox=function(n,t){return this.RenderTextBoxInner(n,t,null,this.GetPropertyName(n.PropertyDescription.PropertyName))},n.prototype.RenderTextBoxInner=function(n,t,i,r){var f,e,s=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider),h=i==null?"":' id="'+i+'"',u=this.GetPropertyBlock(n.PropertyDescription.PropertyName),c=((f=u.TextBoxData)===null||f===void 0?void 0:f.IsInteger)?CSharpType.Int:CSharpType.String,l=CrocoAppCore.Application.FormDataHelper.DataTypeAttributeName+"="+c.toString(),a=((e=u.TextBoxData)===null||e===void 0?void 0:e.IsInteger)?'type="number" step="'+u.TextBoxData.IntStep+'"':'type="text"',o='<label for="'+n.PropertyDescription.PropertyName+'">'+u.LabelText+"<\/label>\n                <input"+h+' autocomplete="off" class="form-control m-input" name="'+r+'" '+l+" "+a+' value="'+s+'" />';return t?this.WrapInForm(n,o):o},n.prototype.RenderTextArea=function(n,t){var r=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider),u=this.GetPropertyBlock(n.PropertyDescription.PropertyName),i='<label for="'+n.PropertyDescription.PropertyName+'">'+u.LabelText+'<\/label>\n            <textarea autocomplete="off" class="form-control m-input" name="'+this.GetPropertyName(n.PropertyDescription.PropertyName)+'" rows="3" style="margin-top: 0px; margin-bottom: 0px; height: 79px;">'+r+"<\/textarea>";return t?this.WrapInForm(n,i):i},n.prototype.RenderGenericDropList=function(n,t,i,r){var f=ValueProviderHelper.GetRawValueFromValueProvider(n,this._model.ValueProvider);this._htmlDrawHelper.ProccessSelectValues(n,f,t);var e=this._selectClass+" form-control m-input m-bootstrap-select m_selectpicker",o=i?(new Map).set("multiple",""):null,s=HtmlDrawHelper.RenderSelect(e,this.GetPropertyName(n.PropertyDescription.PropertyName),t,o),h=this.GetPropertyBlock(n.PropertyDescription.PropertyName),u='<label for="'+n.PropertyDescription.PropertyName+'">'+h.LabelText+"<\/label>"+s;return r?this.WrapInForm(n,u):u},n.prototype.WrapInForm=function(n,t){return'<div class="form-group m-form__group" '+FormDrawHelper.GetOuterFormAttributes(n.PropertyDescription.PropertyName,this._model.Prefix)+">\n                    "+t+"\n                <\/div>"},n.prototype.RenderDropDownList=function(n,t,i){return this.RenderGenericDropList(n,t,!1,i)},n.prototype.RenderMultipleDropDownList=function(n,t,i){return this.RenderGenericDropList(n,t,!0,i)},n}(),GenericInterfaceAppHelper=function(){function n(){this.FormHelper=new GenericForm({FormDrawFactory:CrocoAppCore.GetFormDrawFactory()})}return n.prototype.GetUserInterfaceModel=function(n,t,i){var r={typeName:n,modelPrefix:t};CrocoAppCore.Application.Requester.Post("/Api/Documentation/GenericInterface",r,function(t){if(t==null){alert("Обобщенный интерфейс с названием '"+n+"' не пришёл с сервера");return}i(t)},function(){var t="Произошла ошибка при поиске обобщенного интерфейса по типу "+n;alert(t);CrocoAppCore.Application.Logger.LogAction(t,"","GenericInterfaceAppHelper.GetUserInterfaceModel.ErrorOnRequest",JSON.stringify(r))})},n.prototype.GetEnumModel=function(n,t){var i={typeName:n};CrocoAppCore.Application.Requester.Post("/Api/Documentation/EnumType",i,function(i){if(i==null){alert("Перечисление с названием '"+n+"' не пришло с сервера");return}t(i)},function(){var t="Произошла ошибка при поиске перечеисления с названием "+n;alert(t);CrocoAppCore.Application.Logger.LogAction(t,"","GenericInterfaceAppHelper.GetEnumModel.ErrorOnRequest",JSON.stringify(i))})},n}(),Logger_Resx=function(){function n(){this.LoggingAttempFailed="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения";this.ErrorOnApiRequest="Ошибка запроса к апи";this.ActionLogged="Action logged";this.ExceptionLogged="Исключение залоггировано";this.ErrorOccuredOnLoggingException="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения"}return n}(),Logger=function(){function n(){}return n.prototype.LogException=function(t,i,r){var u={ExceptionDate:(new Date).toISOString(),Description:i,Message:t,Uri:r!==null?r:location.href};CrocoAppCore.Application.Requester.Post("/Api/Log/Exception",u,function(t){return console.log(n.Resources.ExceptionLogged,t)},function(){return alert(n.Resources.ErrorOccuredOnLoggingException)})},n.prototype.LogAction=function(t,i,r,u){var f={LogDate:(new Date).toISOString(),EventId:r,ParametersJson:u,Uri:window.location.href,Description:i,Message:t};CrocoAppCore.Application.Requester.Post("/Api/Log/Action",f,function(t){return console.log(n.Resources.ActionLogged,t)},function(){return alert(n.Resources.LoggingAttempFailed)})},n.Resources=new Logger_Resx,n}(),ModalWorker=function(){function n(){}return n.prototype.ShowModal=function(t){(t===""||t==null||t==undefined)&&(t=n.LoadingModal);$("#"+t).modal("show")},n.prototype.ShowLoadingModal=function(){this.ShowModal(n.LoadingModal)},n.prototype.HideModals=function(){$(".modal").modal("hide");$(".modal-backdrop.fade").remove();$(".modal").on("shown.bs.modal",function(){})},n.prototype.HideModal=function(n){$("#"+n).modal("hide")},n.LoadingModal="loadingModal",n}(),MyCrocoJsApplication=function(){function n(){this.CookieWorker=new CookieWorker;this.FormDataUtils=new FormDataUtils;this.FormDataHelper=new FormDataHelper;this.Logger=new Logger;this.Requester=new Requester;this.ModalWorker=new ModalWorker}return n}(),Requester_Resx=function(){function n(){this.YouPassedAnEmtpyArrayOfObjects="Вы подали пустой объект в запрос";this.ErrorOccuredWeKnowAboutIt="Произошла ошибка! Мы уже знаем о ней, и скоро с ней разберемся!";this.FilesNotSelected="Файлы не выбраны"}return n}(),Requester=function(){function n(){}return n.prototype.DeleteCompletedRequest=function(t){n.GoingRequests=n.GoingRequests.filter(function(n){return n!==t})},n.prototype.SendPostRequestWithAnimation=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!0)},n.prototype.UploadFilesToServer=function(t,i,r,u){var o=this,e=$("#"+t).prop("files"),s=new FormData,f;if(e.length===0){CrocoAppCore.ToastrWorker.ShowError(n.Resources.FilesNotSelected);u&&u();return}for(f=0;f<e.length;f++)s.append("Files",e[f]);$.ajax({url:i,type:"POST",data:s,async:!0,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){o.DeleteCompletedRequest(i);r&&r(n)}.bind(this),error:function(t,r,f){CrocoAppCore.Application.Logger.LogException(r.toString(),"ErrorOnApiRequest",i);o.DeleteCompletedRequest(i);CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt);u&&u(t,r,f)}.bind(this)})},n.OnSuccessAnimationHandler=function(n){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.HandleBaseApiResponse(n)},n.OnErrorAnimationHandler=function(){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt)},n.prototype.Get=function(n,t,i,r){var u=this,f={type:"GET",data:t,url:n,async:!0,cache:!1,success:function(t){u.DeleteCompletedRequest(n);i&&i(t)}.bind(this),error:function(t,i,f){CrocoAppCore.Application.Logger.LogException(i.toString(),"Error on Api Request",n);u.DeleteCompletedRequest(n);r&&r(t,i,f)}.bind(this)};$.ajax(f)},n.prototype.SendAjaxPostInner=function(t,i,r,u,f){var o=this,e,s;if(i==null){alert(n.Resources.YouPassedAnEmtpyArrayOfObjects);return}CrocoAppCore.Application.FormDataUtils.ProccessAllDateTimePropertiesAsString(i);e={};e.type="POST";e.data=i;e.url=t;e.async=!0;e.cache=!1;e.success=function(i){o.DeleteCompletedRequest(t);f&&n.OnSuccessAnimationHandler(i);r&&r(i)}.bind(this);e.error=function(i,r,e){CrocoAppCore.Application.Logger.LogException(r.toString(),"Error on Api Request",t);o.DeleteCompletedRequest(t);f&&n.OnErrorAnimationHandler();u&&u(i,r,e)}.bind(this);s=i.constructor===Array;s&&(e.contentType="application/json; charset=utf-8",e.dataType="json",e.data=JSON.stringify(i));n.GoingRequests.push(t);$.ajax(e)},n.prototype.Post=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!1)},n.Resources=new Requester_Resx,n.GoingRequests=[],n}(),TabFormDrawImplementation=function(){function n(n){this._datePickerPropNames=[];this._selectClass="form-draw-select";this._model=n;this._drawHelper=new HtmlSelectDrawHelper(CrocoAppCore.Application.FormDataHelper.NullValue)}return n.prototype.BeforeFormDrawing=function(){},n.prototype.AfterFormDrawing=function(){var n,t;for($("."+this._selectClass).selectpicker("refresh"),n=0;n<this._datePickerPropNames.length;n++)t=this._datePickerPropNames[n],FormDrawImplementation.InitCalendarForPrefixedProperty(this._model.Prefix,t)},n.prototype.RenderTextBox=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">\n                        '+n.PropertyDescription.PropertyDisplayName+':\n                    <\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        <div class="input-group">\n                            <input type="text" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" class="form-control m-input" placeholder="" value="'+t+'">\n                        <\/div>\n                    <\/div>\n                <\/div>'},n.prototype.RenderTextArea=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">'+n.PropertyDescription.PropertyDisplayName+'<\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        <textarea class="form-control m-input" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" rows="3">'+t+"<\/textarea>\n                    <\/div>\n                <\/div>"},n.prototype.RenderGenericDropList=function(n,t,i){var r=ValueProviderHelper.GetRawValueFromValueProvider(n,this._model.ValueProvider);this._drawHelper.ProccessSelectValues(n,r,t);var u=this._selectClass+" form-control m-input m-bootstrap-select m_selectpicker",f=i?(new Map).set("multiple",""):null,e=HtmlDrawHelper.RenderSelect(u,this.GetPropertyValueName(n.PropertyDescription.PropertyName),t,f);return'<div class="form-group m-form__group row">\n                    <label class="col-xl-3 col-lg-3 col-form-label">'+n.PropertyDescription.PropertyDisplayName+':<\/label>\n                    <div class="col-xl-9 col-lg-9">\n                        '+e+"\n                    <\/div>\n                <\/div>"},n.prototype.RenderDropDownList=function(n,t){return this.RenderGenericDropList(n,t,!1)},n.prototype.RenderMultipleDropDownList=function(n,t){return this.RenderGenericDropList(n,t,!0)},n.prototype.RenderHidden=function(n){var t=ValueProviderHelper.GetStringValueFromValueProvider(n,this._model.ValueProvider);return'<input type="hidden" name="'+this.GetPropertyValueName(n.PropertyDescription.PropertyName)+'" value="'+t+'">'},n.prototype.RenderDatePicker=function(n){return this._datePickerPropNames.push(n.PropertyDescription.PropertyName),this.RenderTextBox(n)},n.prototype.GetPropertyValueName=function(n){return""+this._model.Prefix+n},n}(),ToastrWorker=function(){function n(){}return n.prototype.ShowError=function(n){var t={IsSucceeded:!1,Message:n};this.HandleBaseApiResponse(t)},n.prototype.ShowSuccess=function(n){var t={IsSucceeded:!0,Message:n};this.HandleBaseApiResponse(t)},n.prototype.HandleBaseApiResponse=function(n){if(n.IsSucceeded===undefined||n.Message===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.IsSucceeded?toastr.success(n.Message):toastr.error(n.Message)},n}(),CrocoAppCore=function(){function n(){}return n.GetFormDrawFactory=function(){return new FormDrawFactory({DefaultImplementation:function(n){return new FormDrawImplementation(n)},Implementations:(new Map).set("Default",function(n){return new FormDrawImplementation(n)}).set("Tab",function(n){return new TabFormDrawImplementation(n)})})},n.InitFields=function(){n.Application=new MyCrocoJsApplication;n.AjaxLoader=new AjaxLoader;n.ToastrWorker=new ToastrWorker;n.GenericInterfaceHelper=new GenericInterfaceAppHelper;n.AjaxLoader.InitAjaxLoads()},n}();CrocoAppCore.InitFields();